Title: CVE-2020-13941: Apache Solr information disclosure vulnerability
category: solr/security
cve: CVE-2020-13941

**Severity:** 
Medium

**Versions Affected:**  
Before Solr 8.6.  Some risks are specific to Windows.

**Description:**
Reported in SOLR-14515 (private) and fixed in SOLR-14561 (public), released in Solr version 8.6.0. 
The Replication handler (https://solr.apache.org/guide/8_6/index-replication.html#http-api-commands-for-the-replicationhandler) allows commands backup, restore and deleteBackup. Each of these take a location parameter, which was not validated, i.e you could read/write to any location the solr user can access. 

On a windows system SMB paths such as \\10.0.0.99\share\folder may also be used, leading to:

* The possibility of restoring another SolrCore from a server on the network (or mounted remote file system) may lead to:
    * Exposing search index data that the attacker should otherwise not have access to
    * Replacing the index data entirely by loading it from a remote file system that the attacker controls
* Launching SMB attacks which may result in:
    * The exfiltration of sensitive data such as OS user hashes (NTLM/LM hashes),
    * In case of misconfigured systems, SMB Relay Attacks which can lead to user impersonation on SMB Shares or, in a worse-case scenario, Remote Code Execution 

**Mitigation:**
Upgrade to Solr 8.6, and/or ensure only trusted clients can make requests of Solr's replication handler.

**Credit:**
Matei "Mal" Badanoiu
